---
# Instalaci칩n de Google Chrome

- name: Agregar clave GPG de Google Chrome
  ansible.builtin.apt_key:
    url: https://dl.google.com/linux/linux_signing_key.pub
    state: present
  tags: [ 'chrome' ]

- name: Agregar repositorio de Google Chrome
  ansible.builtin.apt_repository:
    repo: "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main"
    state: present
    filename: google-chrome
  tags: [ 'chrome' ]

- name: Instalar Google Chrome Stable
  ansible.builtin.apt:
    name: google-chrome-stable
    state: present
    update_cache: true
  tags: [ 'chrome' ]

- name: Verificar instalaci칩n de Chrome
  ansible.builtin.command: google-chrome-stable --version
  register: chrome_version_output
  changed_when: false
  failed_when: false
  tags: [ 'chrome' ]

- name: Mostrar versi칩n de Chrome instalada
  ansible.builtin.debug:
    msg: "Chrome instalado: {{ chrome_version_output.stdout }}"
  when: chrome_version_output.rc == 0
  tags: [ 'chrome' ]

- name: Configurar Chrome para no solicitar contrase침a de keyring
  ansible.builtin.copy:
    dest: "/home/{{ item }}/.config/chrome-flags.conf"
    owner: "{{ item }}"
    group: "{{ item }}"
    mode: '0644'
    content: |
      --password-store=basic
      --disable-password-generation
  loop:
  - soporte
  - tienda
  - instalador
  tags: [ 'chrome' ]
